{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"../../services/price.service\";\nimport * as i2 from \"@angular/common/http\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"@angular/forms\";\nfunction ChestEvaluatorComponent_option_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const s_r4 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", s_r4);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(s_r4);\n  }\n}\nfunction ChestEvaluatorComponent_h2_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h2\");\n    i0.ɵɵtext(1, \"Choisir votre coffre\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction ChestEvaluatorComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 7);\n    i0.ɵɵlistener(\"click\", function ChestEvaluatorComponent_div_7_Template_div_click_0_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r7);\n      const c_r5 = restoredCtx.$implicit;\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.selectChest(c_r5));\n    });\n    i0.ɵɵelement(1, \"img\", 8);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const c_r5 = ctx.$implicit;\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵclassProp(\"selected\", c_r5 === ctx_r2.selectedChest);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", c_r5.imagePath, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(c_r5.displayName);\n  }\n}\nfunction ChestEvaluatorComponent_div_8_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 14);\n    i0.ɵɵelement(1, \"img\", 15);\n    i0.ɵɵelementStart(2, \"span\");\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"span\");\n    i0.ɵɵtext(5);\n    i0.ɵɵpipe(6, \"percent\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"input\", 16);\n    i0.ɵɵlistener(\"ngModelChange\", function ChestEvaluatorComponent_div_8_div_4_Template_input_ngModelChange_7_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const item_r9 = restoredCtx.$implicit;\n      return i0.ɵɵresetView(item_r9.userPrice = $event);\n    })(\"ngModelChange\", function ChestEvaluatorComponent_div_8_div_4_Template_input_ngModelChange_7_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r11);\n      const item_r9 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r12.onPriceChange(item_r9));\n    });\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const item_r9 = ctx.$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"src\", item_r9.imagePath, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(item_r9.name);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(6, 4, item_r9.probability, \"1.0-2\"));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngModel\", item_r9.userPrice);\n  }\n}\nfunction ChestEvaluatorComponent_div_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"h3\");\n    i0.ɵɵtext(2, \"Contenu du coffre\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9);\n    i0.ɵɵtemplate(4, ChestEvaluatorComponent_div_8_div_4_Template, 8, 7, \"div\", 10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"button\", 11);\n    i0.ɵɵlistener(\"click\", function ChestEvaluatorComponent_div_8_Template_button_click_5_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r13.calculateTotal());\n    });\n    i0.ɵɵtext(6, \"Pricer\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 12);\n    i0.ɵɵelement(8, \"img\", 13);\n    i0.ɵɵelementStart(9, \"span\");\n    i0.ɵɵtext(10);\n    i0.ɵɵpipe(11, \"number\");\n    i0.ɵɵelementEnd()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r3.selectedChest.outcomes);\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind2(11, 2, ctx_r3.totalPrice, \"1.2-2\"));\n  }\n}\nexport class ChestEvaluatorComponent {\n  constructor(priceService, http) {\n    this.priceService = priceService;\n    this.http = http;\n    this.stages = ['Etage 230–269 (Fantastique)', 'Etage 270–323 (Imaginaire)', 'Etage 324+ (Brumeux)'];\n    this.selectedStage = '';\n    this.chests = [];\n    this.selectedChest = null;\n    this.totalPrice = 0;\n  }\n  ngOnInit() {\n    // initially no chests; they load on stage change\n  }\n  onStageChange() {\n    this.selectedChest = null;\n    this.totalPrice = 0;\n    const url = `http://localhost:5268/api/chests?stage=${encodeURIComponent(this.selectedStage)}`;\n    this.http.get(url).subscribe(data => this.chests = data, console.log('chests from API:', data), err => console.error('API error:', err));\n  }\n  selectChest(chest) {\n    this.selectedChest = {\n      ...chest\n    };\n    this.priceService.setPrice('', 0); // reset\n    this.totalPrice = 0;\n  }\n  onPriceChange(item) {\n    this.priceService.setPrice(item.category, item.userPrice);\n    this.priceService.syncCategory(item.category, this.selectedChest.outcomes);\n    this.calculateTotal();\n  }\n  calculateTotal() {\n    this.totalPrice = this.selectedChest.outcomes.reduce((sum, i) => sum + i.probability * (i.userPrice || 0), 0);\n  }\n  static {\n    this.ɵfac = function ChestEvaluatorComponent_Factory(t) {\n      return new (t || ChestEvaluatorComponent)(i0.ɵɵdirectiveInject(i1.PriceService), i0.ɵɵdirectiveInject(i2.HttpClient));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ChestEvaluatorComponent,\n      selectors: [[\"app-chest-evaluator\"]],\n      decls: 9,\n      vars: 5,\n      consts: [[1, \"container\"], [3, \"ngModel\", \"ngModelChange\", \"change\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngIf\"], [1, \"card-grid\"], [\"class\", \"card\", 3, \"selected\", \"click\", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [1, \"card\", 3, \"click\"], [3, \"src\"], [1, \"loot-grid\"], [\"class\", \"loot-item\", 4, \"ngFor\", \"ngForOf\"], [3, \"click\"], [1, \"price-output\"], [\"src\", \"assets/kamas.png\", \"width\", \"32\"], [1, \"loot-item\"], [\"width\", \"40\", 3, \"src\"], [\"type\", \"number\", \"placeholder\", \"Prix\", 3, \"ngModel\", \"ngModelChange\"]],\n      template: function ChestEvaluatorComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"label\");\n          i0.ɵɵtext(2, \"S\\u00E9lectionnez votre \\u00E9tage:\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(3, \"select\", 1);\n          i0.ɵɵlistener(\"ngModelChange\", function ChestEvaluatorComponent_Template_select_ngModelChange_3_listener($event) {\n            return ctx.selectedStage = $event;\n          })(\"change\", function ChestEvaluatorComponent_Template_select_change_3_listener() {\n            return ctx.onStageChange();\n          });\n          i0.ɵɵtemplate(4, ChestEvaluatorComponent_option_4_Template, 2, 2, \"option\", 2);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(5, ChestEvaluatorComponent_h2_5_Template, 2, 0, \"h2\", 3);\n          i0.ɵɵelementStart(6, \"div\", 4);\n          i0.ɵɵtemplate(7, ChestEvaluatorComponent_div_7_Template, 4, 4, \"div\", 5);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(8, ChestEvaluatorComponent_div_8_Template, 12, 5, \"div\", 3);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngModel\", ctx.selectedStage);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngForOf\", ctx.stages);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedStage);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.chests);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.selectedChest);\n        }\n      },\n      dependencies: [i3.NgForOf, i3.NgIf, i4.NgSelectOption, i4.ɵNgSelectMultipleOption, i4.DefaultValueAccessor, i4.NumberValueAccessor, i4.SelectControlValueAccessor, i4.NgControlStatus, i4.NgModel, i3.DecimalPipe, i3.PercentPipe],\n      styles: [\".container[_ngcontent-%COMP%] {\\n  padding: 20px;\\n  background: #1e1e2f;\\n  color: white;\\n}\\n\\n.card-grid[_ngcontent-%COMP%] {\\n  display: flex;\\n  flex-wrap: wrap;\\n  gap: 10px;\\n}\\n\\n.card[_ngcontent-%COMP%] {\\n  border: 2px solid #666;\\n  padding: 10px;\\n  cursor: pointer;\\n  background: #1e1e2f;\\n  text-align: center;\\n}\\n\\n.card.selected[_ngcontent-%COMP%] {\\n  border-color: #ffd700;\\n  background: #323245;\\n}\\n\\n.loot-grid[_ngcontent-%COMP%] {\\n  display: grid;\\n  grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));\\n  gap: 10px;\\n  margin: 10px 0;\\n}\\n\\n.loot-item[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  gap: 8px;\\n}\\n\\n.price-output[_ngcontent-%COMP%] {\\n  display: flex;\\n  align-items: center;\\n  gap: 6px;\\n  margin-top: 10px;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50cy9jaGVzdC1ldmFsdWF0b3IvY2hlc3QtZXZhbHVhdG9yLmNvbXBvbmVudC5zY3NzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0VBQWEsYUFBQTtFQUFlLG1CQUFBO0VBQXFCLFlBQUE7QUFJakQ7O0FBSEE7RUFBYSxhQUFBO0VBQWUsZUFBQTtFQUFpQixTQUFBO0FBUzdDOztBQVJBO0VBQ0Usc0JBQUE7RUFBd0IsYUFBQTtFQUFlLGVBQUE7RUFDdkMsbUJBQUE7RUFBcUIsa0JBQUE7QUFjdkI7O0FBWkE7RUFBaUIscUJBQUE7RUFBdUIsbUJBQUE7QUFpQnhDOztBQWhCQTtFQUFhLGFBQUE7RUFBZSwyREFBQTtFQUE0RCxTQUFBO0VBQVcsY0FBQTtBQXVCbkc7O0FBdEJBO0VBQWEsYUFBQTtFQUFlLG1CQUFBO0VBQXFCLFFBQUE7QUE0QmpEOztBQTNCQTtFQUFnQixhQUFBO0VBQWUsbUJBQUE7RUFBcUIsUUFBQTtFQUFVLGdCQUFBO0FBa0M5RCIsInNvdXJjZXNDb250ZW50IjpbIi5jb250YWluZXIgeyBwYWRkaW5nOiAyMHB4OyBiYWNrZ3JvdW5kOiAjMWUxZTJmOyBjb2xvcjogd2hpdGU7IH1cclxuLmNhcmQtZ3JpZCB7IGRpc3BsYXk6IGZsZXg7IGZsZXgtd3JhcDogd3JhcDsgZ2FwOiAxMHB4OyB9XHJcbi5jYXJkIHtcclxuICBib3JkZXI6IDJweCBzb2xpZCAjNjY2OyBwYWRkaW5nOiAxMHB4OyBjdXJzb3I6IHBvaW50ZXI7XHJcbiAgYmFja2dyb3VuZDogIzFlMWUyZjsgdGV4dC1hbGlnbjogY2VudGVyO1xyXG59XHJcbi5jYXJkLnNlbGVjdGVkIHsgYm9yZGVyLWNvbG9yOiAjZmZkNzAwOyBiYWNrZ3JvdW5kOiAjMzIzMjQ1OyB9XHJcbi5sb290LWdyaWQgeyBkaXNwbGF5OiBncmlkOyBncmlkLXRlbXBsYXRlLWNvbHVtbnM6IHJlcGVhdChhdXRvLWZpdCwgbWlubWF4KDIwMHB4LDFmcikpOyBnYXA6IDEwcHg7IG1hcmdpbjogMTBweCAwOyB9XHJcbi5sb290LWl0ZW0geyBkaXNwbGF5OiBmbGV4OyBhbGlnbi1pdGVtczogY2VudGVyOyBnYXA6IDhweDsgfVxyXG4ucHJpY2Utb3V0cHV0IHsgZGlzcGxheTogZmxleDsgYWxpZ24taXRlbXM6IGNlbnRlcjsgZ2FwOiA2cHg7IG1hcmdpbi10b3A6IDEwcHg7IH0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["i0","ChestEvaluatorComponent","constructor","priceService","http","ngOnInit","onStageChange","selectedChest","totalPrice","url","encodeURIComponent","selectedStage","get","subscribe","data","chests","console","log","err","error","selectChest","chest","setPrice","onPriceChange","item","category","userPrice","syncCategory","outcomes","calculateTotal","reduce","sum","i","probability","selectors","decls","vars","consts","template","ctx"],"sourceRoot":"","sources":["C:\\Users\\tsouf\\dofus-evaluator-webapp\\client\\src\\app\\components\\chest-evaluator\\chest-evaluator.component.html","C:\\Users\\tsouf\\dofus-evaluator-webapp\\client\\src\\app\\components\\chest-evaluator\\chest-evaluator.component.ts"],"sourcesContent":["<div class=\"container\">\n  <label>Sélectionnez votre étage:</label>\n  <select [(ngModel)]=\"selectedStage\" (change)=\"onStageChange()\">\n    <option *ngFor=\"let s of stages\" [value]=\"s\">{{ s }}</option>\n  </select>\n\n  <h2 *ngIf=\"selectedStage\">Choisir votre coffre</h2>\n\n  <div class=\"card-grid\">\n    <div\n      class=\"card\"\n      *ngFor=\"let c of chests\"\n      [class.selected]=\"c === selectedChest\"\n      (click)=\"selectChest(c)\"\n    >\n      <img [src]=\"c.imagePath\" />\n      <span>{{ c.displayName }}</span>\n    </div>\n  </div>\n\n  <div *ngIf=\"selectedChest\">\n    <h3>Contenu du coffre</h3>\n    <div class=\"loot-grid\">\n      <div class=\"loot-item\" *ngFor=\"let item of selectedChest.outcomes\">\n        <img [src]=\"item.imagePath\" width=\"40\" />\n        <span>{{ item.name }}</span>\n        <span>{{ item.probability | percent: '1.0-2' }}</span>\n        <input\n          type=\"number\"\n          [(ngModel)]=\"item.userPrice\"\n          (ngModelChange)=\"onPriceChange(item)\"\n          placeholder=\"Prix\"\n        />\n      </div>\n    </div>\n    <button (click)=\"calculateTotal()\">Pricer</button>\n    <div class=\"price-output\">\n      <img src=\"assets/kamas.png\" width=\"32\" />\n      <span>{{ totalPrice | number: '1.2-2' }}</span>\n    </div>\n  </div>\n</div>","import { Component, OnInit } from '@angular/core';\nimport { PriceService } from '../../services/price.service';\nimport { HttpClient } from '@angular/common/http';\nimport { Chest } from '../../models/chest.model';\nimport { LootItem } from '../../models/loot-item.model';\n\n\n\n@Component({\n  selector: 'app-chest-evaluator',\n  templateUrl: './chest-evaluator.component.html',\n  styleUrls: ['./chest-evaluator.component.scss'],\n})\nexport class ChestEvaluatorComponent implements OnInit {\n  stages = [\n    'Etage 230–269 (Fantastique)',\n    'Etage 270–323 (Imaginaire)',\n    'Etage 324+ (Brumeux)',\n  ];\n  selectedStage = '';\n  chests: Chest[] = [];\n  selectedChest: Chest | null = null;\n  totalPrice = 0;\n\n  constructor(\n    private priceService: PriceService,\n    private http: HttpClient\n  ) {}\n\n  ngOnInit() {\n    // initially no chests; they load on stage change\n  }\n\n  onStageChange() {\n  this.selectedChest = null;\n  this.totalPrice    = 0;\n\n  const url = `http://localhost:5268/api/chests?stage=${encodeURIComponent(this.selectedStage)}`;\n  this.http.get<Chest[]>(url)\n    .subscribe(\n      data => this.chests = data,\n      console.log('chests from API:', data),\n      err  => console.error('API error:', err)\n    );\n}\n\n  selectChest(chest: Chest) {\n    this.selectedChest = { ...chest };\n    this.priceService.setPrice('', 0); // reset\n    this.totalPrice = 0;\n  }\n\n  onPriceChange(item: LootItem) {\n    this.priceService.setPrice(item.category, item.userPrice);\n    this.priceService.syncCategory(item.category, this.selectedChest!.outcomes);\n    this.calculateTotal();\n  }\n\n  calculateTotal() {\n    this.totalPrice = this.selectedChest!.outcomes.reduce(\n      (sum, i) => sum + i.probability * (i.userPrice || 0),\n      0\n    );\n  }\n}"]},"metadata":{},"sourceType":"module","externalDependencies":[]}